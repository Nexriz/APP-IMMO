// prisma/schema.prisma
datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}


generator client {
  provider = "prisma-client-js"
  // ⚠ pas de clé "output" pour rester compatible averc Next
}

model User {
  id   String     @id @default(cuid())   
  name    String?
  email   String    @unique
  password String
  session Session[]
  annonce Annonce[]  
  Role    Role  @default(USER)
  createdAt DateTime @default(now())
}

model Annonce {
  id          Int             @id @default(autoincrement())
  titre       String
  type        TypeBien  
  description String
  prix        Float
  statutPub   StatutPublication   @default(PUBLIE)
  statutBien   StatutBien
  dateDispo   DateTime            @default(now())
  user        User  @relation(fields: [userId], references: [id])
  userId      String
  photo       Photo[]
  question    Question[]
}

model Session {
  id    String  @id @default(cuid())
  sessionCookie String @unique
  userId String
  user User @relation(fields: [userId], references: [id], onDelete: Cascade)
  expirationDate DateTime
}

model Photo {
  id Int @id @default(autoincrement())
  data Bytes
  mimeType String
  photoName String
  annonce Annonce @relation(fields: [annonceId], references: [id])
  annonceId Int
  createdAt DateTime @default(now())
}

model Question {
  id Int @id @default(autoincrement())
  content String
  answer String?
  annonce Annonce @relation(fields: [annonceId], references: [id])
  annonceId Int
  createdAt DateTime @default(now())
}

enum TypeBien {
  VENDU
  LOCATION
}

enum StatutBien {
  DISPONIBLE
  LOUE
  VENDU
}

enum StatutPublication {
  BROUILLON
  PUBLIE
}

enum Role {
  ADMIN
  USER
  AGENT
}
